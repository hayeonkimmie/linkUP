<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!--property = 변수명 -->
<!--        property: DTO 필드명-->
<!--        column: DB에서 가져온 컬럼명-->
<mapper namespace="mapper.projectmgt">

    <!--resultMap : ProjectMgtDTO + 내부 PayList 리스트 -->
    <resultMap id="projectMgtMap" type="dto.ProjectMgt">
        <id property="projectId" column="project_id" />
        <result property="title" column="title"/>
        <result property="category" column="category"/>
        <result property="skills" column="skills"/>
        <result property="status" column="status"/>
        <result property="regDate" column="reg_date"/>
        <result property="startDate" column="start_date"/>
        <result property="endDate" column="end_date"/>
        <result property="totalAmount" column="total_amount"/>

        <!-- 등급별 구인 정보 (초급/중급/고급) 리스트 => ProjectMgt DTO 내부에 ProjectPay 포함되어있음-->
        <collection property="payList" ofType="dto.ProjectPayDTO">
            <result property="level" column="lv_name"/>
            <result property="fee" column="project_fee"/>
            <result property="count" column="recruit_count"/>
        </collection>
    </resultMap>

<!--        프로젝트 상태별로 리스트 조회-->
    <select id="selectProjectMgtByStatus" resultMap="projectMgtMap" parameterType="String">
        SELECT
#             pj.project_id,
#             pj.advertisement_title,
#             pj.category,
#             pj.req_skills,
# #             프로젝트 상태
#
#             pj.created_date, # 프로젝트 등록일
#             pj.deadline_date, # 구인 마감일
#             pj.category, # 카테고리
#             pj.duration, # 프로젝트 개월 수
#
#             p.lv_id, # 레벨id (초급, 중급, 고급)
#             p.project_fee # 해당 프로젝트 직군 레벨 별 월급
#             pj.start_date, # 프로젝트 시작일
#             pj.end_date, # 프로젝트 끝나는 날
#             pj.total_amount, # 프로젝트 단가

#             l.lv_name,
#             pay.project_fee,
#             COUNT(*) AS recruit_count
    </select>
</mapper>



